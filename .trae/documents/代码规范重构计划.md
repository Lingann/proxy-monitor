# 代码重构计划

根据最新的代码规范 (`code-rules.md`, `name-rules.md`, `tehc-stack-rules.md`)，我制定了以下重构计划。

## 1. 文件重命名 (File Renaming)
遵循 `kebab-case` 命名规则，并根据功能使用更具描述性的名称。

### Core 目录
- `src/core/ConfigManager.ts` -> `src/core/config-manager.ts`
- `src/core/I18nService.ts` -> `src/core/i18n-service.ts`
- `src/core/ModuleManager.ts` -> `src/core/module-manager.ts`

### Shared 目录
- `src/shared/types.ts` -> `src/shared/common-types.ts` (避免通用名称)

### Renderer 目录
- `src/renderer/renderer.ts` -> `src/renderer/renderer-entry.ts` (避免单单词文件名)
- `src/renderer/global.d.ts` -> `src/renderer/renderer-types.d.ts` (更具体)
- `src/renderer/styles.css` -> `src/renderer/app-styles.css`

## 2. 模块化与结构重构 (Modularization & Structure)
遵循单一职责原则，将逻辑从 `index.ts` 中分离。

### Network Monitor 模块 (`src/modules/network-monitor/`)
- 创建 `src/modules/network-monitor/network-monitor-service.ts`: 存放 `NetworkMonitor` 类的核心逻辑。
- 创建 `src/modules/network-monitor/network-monitor-module.ts`: 存放 `NetworkMonitorModule` 的定义。
- 更新 `src/modules/network-monitor/index.ts`: 仅作为导出入口 (Barrel file)。

### Settings 模块 (`src/modules/settings/`)
- 创建 `src/modules/settings/settings-module.ts`: 存放 `SettingsModule` 的定义。
- 更新 `src/modules/settings/index.ts`: 仅作为导出入口。

## 3. 代码质量优化 (Code Quality Improvements)
遵循代码规则：减少嵌套、使用卫语句、中文注释、清理未使用代码。

- **`config-manager.ts`**:
  - 优化 `loadConfig` 方法，移除嵌套 `if`，使用卫语句。
  - 将注释格式统一为 `/* ... */` 并使用中文。

- **`i18n-service.ts`**:
  - 优化 `loadTranslations` 方法，使用卫语句处理文件存在性检查。
  - 优化 `t` 方法的键值遍历逻辑。
  - 添加中文注释。

- **`network-monitor-service.ts`**:
  - 优化 `getConnections` 中的循环逻辑，保持简洁。
  - 确保所有辅助方法（如 `parseMemoryString`）清晰且单一职责。

- **`src/main/index.ts`**:
  - 更新所有引用的文件路径。
  - 确保初始化逻辑清晰，添加必要的中文注释。

## 4. 执行步骤
1.  **重命名文件**：使用文件系统工具对上述文件进行重命名。
2.  **拆分模块**：创建新文件并移动代码逻辑。
3.  **代码重构**：逐个文件检查并应用代码规则（卫语句、注释、循环优化）。
4.  **修复引用**：更新 `main/index.ts` 和其他文件中的 `import` 路径。
5.  **验证**：确保项目可以正常编译和运行（通过 `pnpm run dev` 检查）。
