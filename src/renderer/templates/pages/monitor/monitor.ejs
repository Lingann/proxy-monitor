<link rel="stylesheet" href="pages/monitor/monitor.css">

<!-- List View -->
<div id="monitor-list-view">
    <h1><%= t('modules.network_monitor') %></h1>

    <div class="network-overview-section" style="margin-bottom: 20px;">
        <div class="speed-stats" style="display: flex; gap: 20px; margin-bottom: 15px;">
             <div class="stat-card" style="flex: 1; text-align: center; padding: 15px; background: var(--bg-secondary); border-radius: 8px;">
                <div class="stat-label" style="font-size: 14px; color: var(--text-secondary);"><%= t('monitor.total_upload') %></div>
                <div class="stat-value" id="totalUploadSpeed" style="font-size: 24px; font-weight: 600; color: #FF8787;">0 B/s</div>
             </div>
             <div class="stat-card" style="flex: 1; text-align: center; padding: 15px; background: var(--bg-secondary); border-radius: 8px;">
                <div class="stat-label" style="font-size: 14px; color: var(--text-secondary);"><%= t('monitor.total_download') %></div>
                <div class="stat-value" id="totalDownloadSpeed" style="font-size: 24px; font-weight: 600; color: #4FC3F7;">0 B/s</div>
             </div>
        </div>
        <div id="trafficChart" style="width: 100%; height: 250px; background: var(--bg-secondary); border-radius: 8px; padding: 10px;"></div>
    </div>

    <div class="controls" style="display: none;">
        <button id="analyzeBtn" class="btn btn-primary" style="display: none;"> <!-- Hide manual button as we poll -->
            <i data-feather="activity" style="width: 14px; margin-right: 6px;"></i>
            <%= t('monitor.analyze') %>
        </button>
    </div>

    <div id="status" class="status"></div>

    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-value" id="processCount">0</div>
            <div class="stat-label"><%= t('monitor.processes') %></div>
        </div>
        <div class="stat-card">
            <div class="stat-value" id="connectionCount">0</div>
            <div class="stat-label"><%= t('monitor.connections') %></div>
        </div>
        <div class="stat-card">
            <div class="stat-value" id="serverCount">0</div>
            <div class="stat-label"><%= t('monitor.servers') %></div>
        </div>
        <div class="stat-card">
            <div class="stat-value" id="memoryUsage">0 MB</div>
            <div class="stat-label"><%= t('monitor.memory') %></div>
        </div>
    </div>



    <h2><%= t('monitor.processes') %></h2>
    <div id="processTableContainer"></div>
</div>

<!-- Details View -->
<div id="monitor-details-view" style="display: none;">
    <div class="view-header">
        <button id="backToMonitorBtn" class="btn-icon">
            <i data-feather="arrow-left"></i>
        </button>
        <h2><%= t('details.title') %>: <span id="detailProcessName"></span></h2>
    </div>
    
    <div class="details-content">
        <div class="info-card">
            <h3><%= t('details.basic_info') %></h3>
            <p><strong><%= t('table.pid') %>:</strong> <span id="detailPid"></span></p>
            <p><strong><%= t('table.category') %>:</strong> <span id="detailCategory"></span></p>
            <p><strong><%= t('monitor.memory') %>:</strong> <span id="detailMemory"></span></p>
            <p><strong><%= t('monitor.cpu') %>:</strong> <span id="detailCpu"></span>%</p>
        </div>

        <h3><%= t('details.process_servers') %></h3>
        <div id="detailServerTableContainer"></div>

        <h3><%= t('details.active_connections') %></h3>
        <div id="detailConnectionTableContainer"></div>
    </div>
</div>

<!-- Dropdown Menu Template (Hidden) -->
<div id="actionDropdown" class="dropdown-menu" style="display: none;">
    <div class="dropdown-item" data-action="details"><%= t('actions.view_details') %></div>
    <div class="dropdown-item" data-action="limit"><%= t('actions.limit_speed') %></div>
    <div class="dropdown-item" data-action="end"><%= t('actions.end_process') %></div>
    <div class="dropdown-item" data-action="locate"><%= t('actions.locate_file') %></div>
    <div class="dropdown-item" data-action="properties"><%= t('actions.properties') %></div>
</div>
