// ======================================================
// 颜色处理函数
// ======================================================
@use 'sass:color';
@use 'sass:list';
@use 'sass:math';

// 将十六进制颜色转换为RGB列表
// @param {Color} $color - 需要转换的颜色
// @return {List} - 包含r, g, b值的列表
@function hex-to-rgb($color) {
  @return (
    color.channel($color, "red", $space: rgb),
    color.channel($color, "green", $space: rgb),
    color.channel($color, "blue", $space: rgb)
  );
}

// 将RGB列表转为以逗号分隔的字符串，用于CSS变量
// @param {List} $rgb - RGB值列表
// @return {String} - 以逗号分隔的RGB字符串
@function rgb-to-string($rgb) {
  @return '#{list.nth($rgb, 1)}, #{list.nth($rgb, 2)}, #{list.nth($rgb, 3)}';
}

// 将颜色转换为RGB字符串形式
// @param {Color} $color - 需要转换的颜色
// @return {String} - 返回rgb(r, g, b)形式的字符串
@function to-rgb-string($color) {
  $rgb: hex-to-rgb($color);

  @return 'rgb(#{list.nth($rgb, 1)}, #{list.nth($rgb, 2)}, #{list.nth($rgb, 3)})';
}

// 将颜色转换为RGBA字符串形式
// @param {Color} $color - 需要转换的颜色
// @param {Number} $alpha - 透明度
// @return {String} - 返回rgba(r, g, b, a)形式的字符串
@function to-rgba-string($color, $alpha: 1) {
  $rgb: hex-to-rgb($color);

  @return 'rgba(#{list.nth($rgb, 1)}, #{list.nth($rgb, 2)}, #{list.nth($rgb, 3)}, #{$alpha})';
}

// 混合两个颜色
// @param {Color} $color1 - 第一个颜色
// @param {Color} $color2 - 第二个颜色
// @param {Number} $weight - 第二个颜色的权重 (0-1)
// @return {Color} - 混合后的颜色
@function color-mix($color1, $color2, $weight: 0.5) {
  @return color.mix($color2, $color1, math.percentage($weight));
}

// 调亮颜色
// @param {Color} $color - 基础颜色
// @param {Number} $amount - 调亮的程度 (0-1)
// @return {Color} - 调亮后的颜色
@function lighten-color($color, $weight: 0.2) {
  // 1. 使用白色混合代替直接调整亮度，保持色彩纯度
  $mixed: color.mix(white, $color, math.percentage($weight));
  
  // 2. 模拟自然光：颜色变亮时，色相微调（暖色向黄偏，冷色向青偏）
  $hue-adjust: if(color.channel($color, "hue", $space: hsl) < 200, -2deg, 2deg);
  
  @return color.adjust($mixed, $hue: $hue-adjust);
}

// 调暗颜色
// @param {Color} $color - 基础颜色
// @param {Number} $amount - 调暗的程度 (0-1)
// @return {Color} - 调暗后的颜色
@function darken-color($color, $weight: 0.2) {
  // 1. 使用黑色混合
  $mixed: color.mix(black, $color, math.percentage($weight));
  
  // 2. 补偿：颜色变暗时，通常需要提高一点饱和度，防止颜色变“焦”
  @return color.adjust($mixed, $saturation: 5%, $hue: 2deg);
}

// 调整颜色饱和度
// @param {Color} $color - 基础颜色
// @param {Number} $amount - 调整饱和度的程度 (-1到1)
// @return {Color} - 调整后的颜色
@function adjust-saturation($color, $amount: 0.1) {
  @return color.adjust($color, $saturation: math.percentage($amount));
}
